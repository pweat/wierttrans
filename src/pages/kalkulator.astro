---
// src/pages/kalkulator.astro
import Layout from "../layouts/Layout.astro";
---

<Layout
  title="Centrum Korzy≈õci"
  description="Oblicz swoje oszczƒôdno≈õci, zobacz potencjalne korzy≈õci i odkryj, jak wiele zyskasz dziƒôki w≈Çasnej studni g≈Çƒôbinowej."
>
  <div class="max-w-3xl mx-auto">
    <div class="text-center">
      <h1 class="text-4xl font-bold text-gray-800 mb-4">
        Centrum Korzy≈õci W≈Çasnej Studni
      </h1>
      <p class="text-lg text-gray-600 mb-8">
        Wprowad≈∫ swoje obecne rachunki za wodƒô, aby odkryƒá potencjalne
        oszczƒôdno≈õci i korzy≈õci p≈ÇynƒÖce z niezale≈ºno≈õci.
      </p>
    </div>

    <div
      id="kalkulator"
      class="bg-white p-6 rounded-lg shadow-lg border border-gray-200"
    >
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div>
          <label for="cena-wody" class="block mb-2 font-semibold text-gray-700"
            >Cena za 1 m¬≥ wody (z≈Ç):</label
          >
          <input
            type="number"
            id="cena-wody"
            class="w-full p-2 border border-gray-300 rounded"
            placeholder="np. 12.50"
          />
        </div>
        <div>
          <label
            for="zuzycie-wody"
            class="block mb-2 font-semibold text-gray-700"
            >Miesiƒôczne zu≈ºycie (m¬≥):</label
          >
          <input
            type="number"
            id="zuzycie-wody"
            class="w-full p-2 border border-gray-300 rounded"
            placeholder="np. 10"
          />
        </div>
      </div>
      <button
        id="oblicz-btn"
        class="w-full bg-red-600 text-white font-bold py-3 px-4 rounded hover:bg-red-700 transition duration-300"
      >
        Odkryj Korzy≈õci
      </button>
    </div>

    <div id="wynik-container" class="hidden mt-8 space-y-8">
      <div class="bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">
          Twoje Oszczƒôdno≈õci
        </h2>
        <div class="text-center">
          <p class="text-lg text-gray-700">Miesiƒôcznie zaoszczƒôdzisz oko≈Ço:</p>
          <p id="wynik-miesiac" class="text-4xl font-bold text-green-600 my-2">
            0 z≈Ç
          </p>
          <p class="text-lg text-gray-700 mt-4">Co rocznie daje kwotƒô:</p>
          <p id="wynik-rok" class="text-4xl font-bold text-green-600 my-2">
            0 z≈Ç
          </p>
          <p id="wynik-analogia" class="text-md text-gray-500 mt-2"></p>
        </div>
      </div>

      <div class="bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">
          Skala Zu≈ºycia Wody
        </h2>
        <div id="wynik-woda" class="text-center text-lg text-gray-700"></div>
      </div>

      <div class="bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">
          To nie wszystko! Zyskujesz r√≥wnie≈º:
        </h2>
        <ul class="space-y-3 text-lg">
          <li class="flex items-start">
            <span class="text-green-500 mr-2">‚úÖ</span> Niezale≈ºno≈õƒá od ogranicze≈Ñ
            sieci wodociƒÖgowej.
          </li>
          <li class="flex items-start">
            <span class="text-green-500 mr-2">‚úÖ</span> Nieograniczone mo≈ºliwo≈õci
            podlewania ogrodu bez obaw o rachunki.
          </li>
          <li class="flex items-start">
            <span class="text-green-500 mr-2">‚úÖ</span> Wodƒô o sta≈Çym, wysokim ci≈õnieniu,
            wolnƒÖ od chloru.
          </li>
          <li class="flex items-start">
            <span class="text-green-500 mr-2">‚úÖ</span> PewnƒÖ inwestycjƒô, kt√≥ra podnosi
            warto≈õƒá Twojej nieruchomo≈õci.
          </li>
        </ul>
      </div>
    </div>
  </div>
</Layout>

<script>
  const KOSZT_STUDNI = 20000;

  const cenaWodyInput = document.getElementById("cena-wody");
  const zuzycieWodyInput = document.getElementById("zuzycie-wody");
  const obliczBtn = document.getElementById("oblicz-btn");
  const wynikContainer = document.getElementById("wynik-container");

  const wynikMiesiacEl = document.getElementById("wynik-miesiac");
  const wynikRokEl = document.getElementById("wynik-rok");
  const wynikAnalogiaEl = document.getElementById("wynik-analogia");
  const wynikWodaEl = document.getElementById("wynik-woda");

  // --- NOWA FUNKCJA Z CIEKAWOSTKAMI ---
  function getCiekawostkaWodna(roczneLitry) {
    // 1 fili≈ºanka kawy ‚âà 140 litr√≥w wody (ca≈Çy proces produkcji)
    const filizankiKawy = Math.round(roczneLitry / 140);
    // 1 kg wo≈Çowiny ‚âà 15 000 litr√≥w wody
    const kgWolowiny = (roczneLitry / 15000).toFixed(1);

    if (roczneLitry <= 70000) {
      // Mniej ni≈º ~40m¬≥ rocznie
      return `Dla por√≥wnania, do wyprodukowania <strong>${filizankiKawy} fili≈ºanek kawy</strong> ‚òï potrzeba podobnej ilo≈õci wody!`;
    } else {
      return `Dla por√≥wnania, do wyprodukowania <strong>${kgWolowiny} kg wo≈Çowiny</strong> ü•© potrzeba podobnej ilo≈õci wody!`;
    }
  }
  // --- KONIEC NOWEJ FUNKCJI ---

  obliczBtn.addEventListener("click", () => {
    const cena = parseFloat(cenaWodyInput.value);
    const zuzycie = parseFloat(zuzycieWodyInput.value);

    if (isNaN(cena) || isNaN(zuzycie) || cena <= 0 || zuzycie <= 0) {
      alert("Proszƒô wype≈Çniƒá oba pola poprawnymi, dodatnimi liczbami.");
      return;
    }

    const miesieczneOszczednosci = cena * zuzycie;
    const roczneOszczednosci = miesieczneOszczednosci * 12;
    const roczneZuzycieM3 = zuzycie * 12;
    const roczneZuzycieLitry = roczneZuzycieM3 * 1000;
    const iloscWann = Math.round(roczneZuzycieLitry / 150);

    wynikMiesiacEl.textContent = `${miesieczneOszczednosci.toFixed(2)} z≈Ç`;
    wynikRokEl.textContent = `${roczneOszczednosci.toFixed(2)} z≈Ç`;

    // U≈ºywamy nowej funkcji do wygenerowania ciekawostki
    const ciekawostka = getCiekawostkaWodna(roczneZuzycieLitry);
    wynikWodaEl.innerHTML = `
      Rocznie zu≈ºywasz <strong>${roczneZuzycieM3.toFixed(0)} m¬≥</strong> (${roczneZuzycieLitry.toLocaleString("pl-PL")} litr√≥w) wody. 
      To tyle, ile mie≈õci siƒô w oko≈Ço <strong>${iloscWann} wannach</strong>! üõÅ
      <br><br>
      <span class="text-base text-blue-600">${ciekawostka}</span>
    `;

    let analogiaTekst = "";
    if (roczneOszczednosci <= 500) {
      analogiaTekst = "kilkana≈õcie bilet√≥w do kina üçø";
    } else if (roczneOszczednosci <= 800) {
      analogiaTekst =
        "op≈Çacenie rocznej subskrypcji ulubionego serwisu streamingowego üì∫";
    } else if (roczneOszczednosci <= 2000) {
      analogiaTekst = "dobry ekspres do kawy ‚òï";
    } else {
      analogiaTekst = "nowy smartfon lub weekendowy wyjazd dla dw√≥ch os√≥b üì±";
    }
    wynikAnalogiaEl.textContent = `Za takƒÖ kwotƒô m√≥g≈Çby≈õ co roku kupiƒá np. ${analogiaTekst}.`;

    wynikContainer.classList.remove("hidden");

    wynikContainer.scrollIntoView({ behavior: "smooth", block: "start" });
  });
</script>
